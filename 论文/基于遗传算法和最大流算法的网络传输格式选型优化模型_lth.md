##网络传输格式选型评价模型
符号说明
$Req$全省所需要的网络流量
$Cost$建设网络所需要的标准成本
$W$ 网络对全省网络需求的满足率
$f_K$ 当前配置方式下全省最大允许的网络流量
$L$ 网络传输格式设置向量，长度21
$D$ 路径距离向量，长度21
$K$ 每条路径采用的网络线路数量向量，长度21
$C$ 每条路径网络流量容量向量，长度21
$l_i$ 第i条路径的传输格式设置
$d_i$ 第i条路径的距离
$k_i$ 第i条路径采用的网络线路数量,由附件可知最大为80
$c_i$ 第i条路径网络流量容量;
$K_m$ 由遗传算法计算得出的最优网络线路数量向量
由上文已经确定的网络构建模型,广东省布置骨干网需要21条线路，分析附件给出的传输容量与价格关系表可知，选用线路容量为$800Gb/s$的性价比最高选用$400Gb/s$的最低，但我们只能在不同传输格式下最长传输距离的限制下挑选尽可能性价比高的传输格式，对于我们已经构建的网络，将$80km$以内的线路全部选用线路容量为$800Gb/s$，$80km-100km$距离的线路选用线路容量为$600Gb/s$，$200km$以内距离的线路选用线路容量为$400Gb/s$是同等传输容量下线路成本最低的选择。$$l_i=\begin{cases}
   800 &\text{if }  &d_i\leqslant80 \\
   600 &\text{if }  ~ 80~< &d_i\leqslant100\\
   400 &\text{if }  100< &d_i\leqslant200 \\
\end{cases} \bigg(\LARGE i<21\bigg)$$
每条路径网络流量容量向量$$C=L \sdot K$$
建设网络所需成本$$Cost=\sum_{i=1}^{21}k_i\frac{\frac{l_i}{100}+4}{8}$$
网络对全省网络需求的满足率$$W=\frac{f_K}{Req}*100\%$$
网络传输格式选型评价函数$$G(K)=\begin{cases}
    Cost &\text{if} ~~W=100\%\\
    inf    &\text{if} ~~W\not=100\%
\end{cases}
$$
骨干网问题1的目标则是取得$G(K)$的最小值

其中，对$W$的计算使用了最大流算法，步骤如下
步骤1：设置一个超级汇点，除广州外的每个城市都与超级汇相连，且与超级汇点存在一条由该城市出发流入超级汇，容量为该城市需求量的路径，超级汇点编号为20。
步骤2：通过$K$初始化残余网络
步骤3：在网络中寻找增广路并更新残余网络，增加流量。
重复步骤3，直到无增广路，得到的流量$f_K$除以全省所需流量$Req$即得到$W$

由于该问题的搜索空间达到$21^{80}$非常庞大,所以我们选择遗传算法解决这一问题，遗传算法计算流程已经在解决微波问题的过程中详细阐述，这里不再赘述。
只重点介绍上文中“网络传输格式选型评价模型”如何运用在遗传算法中。
我们尝试将上文中的评价函数直接取倒数采用遗传算法找到它的最大值但是效果并不佳，因为上文评价函数筛选掉了很多只需少许变异就能使$W$达到$100\%$的个体，对此，我们采用优化后的评价函数做为遗传算法的适应度函数，公式为$$G_0(K)=\frac{e^{c_1W}}{e^{c_2Cost}};$$
采用该适应度函数保留了大部分条件十分接近目标的值，如图
（@import "cost_spot.jpg" 我没装插件看不到）
我们选取其中最优值点$K_m$，观察这个配置方式经过最大流算法计算后的残余网络发现，网路的流量没有从路径12和路径4走，于是我们改进了由网络构建模型的到了网络构建图，删除了这两条路径。继续观察残余网络发现网络的配置仍然有冗余，在减少冗余配置之后即可取得最佳的网络传输格式选型。

##模型的求解
1.路径编号
编号|1 | 2 | 3 | 4 | 5|6  | 7 |  8| 9| 10 |11
:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
端点|广州|广州|广州|佛山|广州|江门|佛山|肇庆|中山|广州|惠州|
端点|佛山|东莞|江门|江门|清远|中山|肇庆|清远|珠海|深圳|东莞|
距离/km|19.1|49.9|62.2|48.7|64.0|33.9|64.6|84.3|27.4|106.0|65.6|
编号| 12 | 13 | 14 | 15|16   |  17 |  18 |   19 | 20|21|
端点|惠州|肇庆|清远|惠州|江门|云浮|湛江|惠州|汕尾|揭阳|
端点|深圳|云浮|韶关|河源|阳江|茂名|茂名|汕尾|揭阳|梅州|
距离/km|64.8|51.4|128.7|85.9|142.1|179|76.4|102|130.5|80.6|
2.城市编号
1|2|3|4|5|6|7|8|9|10|11|12|13|14|15|16|17|18|19|
:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
|广州|佛山|东莞|江门|清远|中山|肇庆|珠海|深圳|惠州|云浮|韶关|河源|阳江|湛江|茂名|汕尾|揭阳三市|梅州|

$查表D=[19.1~49.9~62.2~48.7~64.0~33.9~64.6~84.3~27.4~106.0~65.6~64.8~51.4~128.7~85.9~142.1~179~76.4~102~130.5~80.6]$
由$D$有
$L=[800~800~800~800~800~800~800~600~800~400~800~800~800~400~600~400~400~800~400~400~600]$
遗传算法参数：
迭代:5000代
种群大小：100
交叉机率：0.7
变异机率：0.15
适应度参数$c_1=10~~~~c_2=\frac{1}{1000}$ 
（代码见附件4）
遗传过程
（此处有图片 遗传过程.jpg）
经过排除冗余得到最优结果
$K=[45~66~31~0~15~16~32~2~8~36~53~0~26~13~9~12~40~11~75~63~10]$
成本$Cost_{min}=1439.5X$
结果如图
（把ldl费尽心思画的 广东行政图更改(加数据和线).png）